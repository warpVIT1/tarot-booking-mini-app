<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∞–¥–º–∏–Ω–∫–∏ */
        .admin-warning {
            background: linear-gradient(45deg, #ff6b6b, #ffd93d);
            color: #fff;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
        }

        .access-form {
            max-width: 400px;
            margin: 50px auto;
            padding: 30px;
            background: #fff;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .access-denied {
            color: #ff4757;
            background: #ffe8e8;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #ff4757;
        }

        .admin-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .admin-action-card {
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }

        .danger-zone {
            background: #fff5f5;
            border: 1px solid #fed7d7;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .danger-zone h3 {
            color: #e53e3e;
            margin-bottom: 15px;
        }

        .btn-danger {
            background: #e53e3e;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
        }

        .btn-warning {
            background: #dd6b20;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
        }
    </style>
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
    <div id="auth-screen" class="screen active">
        <div class="access-form">
            <div class="admin-warning">
                üîí –ó–ê–©–ò–©–ï–ù–ù–ê–Ø –ó–û–ù–ê
            </div>

            <h2>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø</h2>
            <p>–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</p>

            <div class="form-group">
                <label>–ö–æ–¥ –¥–æ—Å—Ç—É–ø–∞:</label>
                <input type="password" id="access-code" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥">
            </div>

            <button onclick="checkAccess()" class="primary-btn">
                üîë –í–æ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
            </button>

            <div id="access-error" class="access-denied" style="display: none;">
                ‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞
            </div>

            <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee; text-align: center; color: #666; font-size: 0.9rem;">
                –¢–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞
            </div>
        </div>
    </div>

    <!-- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å -->
    <div id="admin-panel" class="screen">
        <div class="app-header">
            <div class="user-info">
                <div class="avatar">üõ°Ô∏è</div>
                <div class="user-details">
                    <h3>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</h3>
                    <p>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</p>
                </div>
            </div>
            <div class="header-actions">
                <button onclick="logout()" class="btn-danger">–í—ã–π—Ç–∏</button>
            </div>
        </div>

        <div class="content">
            <!-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="admin-warning">
                ‚ö†Ô∏è –í—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏. –ë—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏!
            </div>

            <div class="section-header">
                <h2>üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã</h2>
            </div>

            <div class="admin-stats-grid" id="admin-stats">
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>

            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ -->
            <div class="admin-action-card">
                <h3>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button onclick="viewAllUsers()" class="secondary-btn">–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
                    <button onclick="viewAllClients()" class="secondary-btn">–ö–ª–∏–µ–Ω—Ç—ã</button>
                    <button onclick="viewAllTarots()" class="secondary-btn">–¢–∞—Ä–æ–ª–æ–≥–∏</button>
                    <button onclick="exportUsers()" class="secondary-btn">–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
                </div>
            </div>

            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—è–º–∏ -->
            <div class="admin-action-card">
                <h3>üìÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—è–º–∏</h3>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button onclick="viewAllBookings()" class="secondary-btn">–í—Å–µ –∑–∞–ø–∏—Å–∏</button>
                    <button onclick="viewPendingBookings()" class="secondary-btn">–û–∂–∏–¥–∞—é—â–∏–µ</button>
                    <button onclick="generateReports()" class="secondary-btn">–û—Ç—á–µ—Ç—ã</button>
                </div>

                <div id="bookings-data" style="margin-top: 20px;">
                    <!-- –î–∞–Ω–Ω—ã–µ –æ –∑–∞–ø–∏—Å—è—Ö -->
                </div>
            </div>

            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π -->
            <div class="admin-action-card">
                <h3>‚öôÔ∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</h3>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button onclick="cleanupExpiredData()" class="btn-warning">–û—á–∏—Å—Ç–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ</button>
                    <button onclick="optimizeStorage()" class="secondary-btn">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</button>
                    <button onclick="backupData()" class="secondary-btn">–°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø</button>
                    <button onclick="viewSystemInfo()" class="secondary-btn">–°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</button>
                </div>
            </div>

            <!-- –û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞ -->
            <div class="danger-zone">
                <h3>‚ö†Ô∏è –û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞</h3>
                <p>–≠—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è –Ω–µ–æ–±—Ä–∞—Ç–∏–º—ã. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å –∫—Ä–∞–π–Ω–µ–π –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é!</p>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button onclick="clearAllBookings()" class="btn-danger">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏</button>
                    <button onclick="clearAllUsers()" class="btn-danger">–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
                    <button onclick="factoryReset()" class="btn-danger">–°–±—Ä–æ—Å —Å–∏—Å—Ç–µ–º—ã</button>
                </div>
            </div>

            <!-- –õ–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ -->
            <div class="admin-action-card">
                <h3>üìã –õ–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</h3>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button onclick="viewErrorLogs()" class="secondary-btn">–õ–æ–≥–∏ –æ—à–∏–±–æ–∫</button>
                    <button onclick="viewActivityLogs()" class="secondary-btn">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</button>
                    <button onclick="clearLogs()" class="btn-warning">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏</button>
                </div>

                <div id="logs-container" style="margin-top: 20px; max-height: 300px; overflow-y: auto; background: #f8f9fa; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 0.9rem;">
                    <!-- –õ–æ–≥–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞ (–≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π)
        const ACCESS_CODES = [
            btoa('admin2024'), // admin2024
            btoa('tarot_admin'), // tarot_admin
            btoa('secure_access') // secure_access
        ];

        let isAuthenticated = false;

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞
        function checkAccess() {
            const inputCode = document.getElementById('access-code').value;
            const encodedInput = btoa(inputCode);

            if (ACCESS_CODES.includes(encodedInput)) {
                isAuthenticated = true;
                document.getElementById('auth-screen').classList.remove('active');
                document.getElementById('admin-panel').classList.add('active');
                initAdminPanel();
                document.getElementById('access-error').style.display = 'none';
            } else {
                document.getElementById('access-error').style.display = 'block';
                document.getElementById('access-code').value = '';

                // –õ–æ–≥–≥–∏—Ä—É–µ–º –ø–æ–ø—ã—Ç–∫—É –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
                console.warn('Unauthorized access attempt at:', new Date().toISOString());
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
        function initAdminPanel() {
            loadAdminStats();
            startAutoRefresh();
            console.log('Admin panel initialized at:', new Date().toISOString());
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function loadAdminStats() {
            try {
                const users = JSON.parse(localStorage.getItem('tarot_user_data') || '[]');
                const bookings = JSON.parse(localStorage.getItem('tarot_bookings') || '[]');
                const slots = JSON.parse(localStorage.getItem('tarot_time_slots') || '[]');

                const stats = {
                    totalUsers: Array.isArray(users) ? users.length : (users.id ? 1 : 0),
                    totalBookings: bookings.length,
                    activeSlots: slots.filter(s => s.status === 'available').length,
                    pendingBookings: bookings.filter(b => b.status === 'pending').length,
                    confirmedBookings: bookings.filter(b => b.status === 'confirmed').length,
                    storageSize: getStorageSize()
                };

                document.getElementById('admin-stats').innerHTML = `
                    <div class="stat-card">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-info">
                            <div class="stat-number">${stats.totalUsers}</div>
                            <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìÖ</div>
                        <div class="stat-info">
                            <div class="stat-number">${stats.totalBookings}</div>
                            <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚è≥</div>
                        <div class="stat-info">
                            <div class="stat-number">${stats.pendingBookings}</div>
                            <div class="stat-label">–û–∂–∏–¥–∞—é—Ç</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-info">
                            <div class="stat-number">${stats.confirmedBookings}</div>
                            <div class="stat-label">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üïê</div>
                        <div class="stat-info">
                            <div class="stat-number">${stats.activeSlots}</div>
                            <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üíæ</div>
                        <div class="stat-info">
                            <div class="stat-number">${(stats.storageSize / 1024).toFixed(1)}kb</div>
                            <div class="stat-label">–î–∞–Ω–Ω—ã—Ö</div>
                        </div>
                    </div>
                `;
            } catch (error) {
                console.error('Error loading admin stats:', error);
            }
        }

        // –ü–æ–ª—É—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
        function getStorageSize() {
            let total = 0;
            for (let key in localStorage) {
                if (localStorage.hasOwnProperty(key)) {
                    total += localStorage[key].length;
                }
            }
            return total;
        }

        // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        function startAutoRefresh() {
            setInterval(() => {
                if (isAuthenticated) {
                    loadAdminStats();
                }
            }, 30000);
        }

        // –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        function viewAllUsers() {
            alert('–û—Ç–∫—Ä—ã—Ç–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...');
        }

        function viewAllClients() {
            alert('–û—Ç–∫—Ä—ã—Ç–∏–µ —Å–ø–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤...');
        }

        function viewAllTarots() {
            alert('–û—Ç–∫—Ä—ã—Ç–∏–µ —Å–ø–∏—Å–∫–∞ —Ç–∞—Ä–æ–ª–æ–≥–æ–≤...');
        }

        function exportUsers() {
            const data = {
                users: localStorage.getItem('tarot_user_data'),
                bookings: localStorage.getItem('tarot_bookings'),
                slots: localStorage.getItem('tarot_time_slots'),
                exportDate: new Date().toISOString()
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `tarot_backup_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function viewAllBookings() {
            const bookings = JSON.parse(localStorage.getItem('tarot_bookings') || '[]');
            document.getElementById('bookings-data').innerHTML = `
                <h4>–í—Å–µ –∑–∞–ø–∏—Å–∏ (${bookings.length})</h4>
                <div style="max-height: 300px; overflow-y: auto;">
                    ${bookings.map(booking => `
                        <div style="border: 1px solid #ddd; padding: 10px; margin: 5px 0; border-radius: 5px;">
                            <strong>ID:</strong> ${booking.id}<br>
                            <strong>–ö–ª–∏–µ–Ω—Ç:</strong> ${booking.clientName || 'N/A'}<br>
                            <strong>–°—Ç–∞—Ç—É—Å:</strong> ${booking.status}<br>
                            <strong>–î–∞—Ç–∞:</strong> ${new Date(booking.createdAt).toLocaleString('ru-RU')}
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function viewPendingBookings() {
            const bookings = JSON.parse(localStorage.getItem('tarot_bookings') || '[]');
            const pending = bookings.filter(b => b.status === 'pending');
            alert(`–û–∂–∏–¥–∞—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π: ${pending.length}`);
        }

        function generateReports() {
            alert('–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤...');
        }

        function cleanupExpiredData() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ?')) {
                // –õ–æ–≥–∏–∫–∞ –æ—á–∏—Å—Ç–∫–∏
                alert('–£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã');
                loadAdminStats();
            }
        }

        function optimizeStorage() {
            alert('–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞');
        }

        function backupData() {
            exportUsers(); // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é —ç–∫—Å–ø–æ—Ä—Ç–∞
        }

        function viewSystemInfo() {
            const info = {
                userAgent: navigator.userAgent,
                storage: getStorageSize(),
                timestamp: new Date().toISOString(),
                localStorage: Object.keys(localStorage).length + ' –∫–ª—é—á–µ–π'
            };
            alert('–°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:\n' + JSON.stringify(info, null, 2));
        }

        function clearAllBookings() {
            if (confirm('–í–ù–ò–ú–ê–ù–ò–ï! –≠—Ç–æ —É–¥–∞–ª–∏—Ç –í–°–ï –∑–∞–ø–∏—Å–∏. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                if (confirm('–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ! –¢–æ—á–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                    localStorage.removeItem('tarot_bookings');
                    alert('–í—Å–µ –∑–∞–ø–∏—Å–∏ —É–¥–∞–ª–µ–Ω—ã');
                    loadAdminStats();
                }
            }
        }

        function clearAllUsers() {
            if (confirm('–í–ù–ò–ú–ê–ù–ò–ï! –≠—Ç–æ —É–¥–∞–ª–∏—Ç –í–°–ï–• –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                if (confirm('–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ! –¢–æ—á–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                    localStorage.removeItem('tarot_user_data');
                    alert('–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–¥–∞–ª–µ–Ω—ã');
                    loadAdminStats();
                }
            }
        }

        function factoryReset() {
            if (confirm('–ü–û–õ–ù–´–ô –°–ë–†–û–° –°–ò–°–¢–ï–ú–´! –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã!')) {
                if (confirm('–≠—Ç–æ —É–¥–∞–ª–∏—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –¢–æ—á–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                    if (confirm('–ü–û–°–õ–ï–î–ù–ï–ï –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï! –¢–æ—á–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ?')) {
                        localStorage.clear();
                        alert('–°–∏—Å—Ç–µ–º–∞ —Å–±—Ä–æ—à–µ–Ω–∞. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
                        setTimeout(() => location.reload(), 2000);
                    }
                }
            }
        }

        function viewErrorLogs() {
            document.getElementById('logs-container').innerHTML = '–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞';
        }

        function viewActivityLogs() {
            document.getElementById('logs-container').innerHTML = '–õ–æ–≥–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã';
        }

        function clearLogs() {
            document.getElementById('logs-container').innerHTML = '–õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã';
        }

        function logout() {
            if (confirm('–í—ã–π—Ç–∏ –∏–∑ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏?')) {
                isAuthenticated = false;
                document.getElementById('admin-panel').classList.remove('active');
                document.getElementById('auth-screen').classList.add('active');
                document.getElementById('access-code').value = '';
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ Enter –≤ –ø–æ–ª–µ –ø–∞—Ä–æ–ª—è
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('access-code').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    checkAccess();
                }
            });
        });

        // –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–ø—ã—Ç–æ–∫ –≤–∑–ª–æ–º–∞
        let failedAttempts = 0;
        const originalCheckAccess = checkAccess;
        checkAccess = function() {
            if (failedAttempts > 5) {
                alert('–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫. –î–æ—Å—Ç—É–ø –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω.');
                return;
            }

            const inputCode = document.getElementById('access-code').value;
            const encodedInput = btoa(inputCode);

            if (!ACCESS_CODES.includes(encodedInput)) {
                failedAttempts++;
                console.warn(`Failed attempt #${failedAttempts} at:`, new Date().toISOString());
            }

            originalCheckAccess();
        };
    </script>
</body>
</html>